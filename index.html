<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Image to GitHub</title>
</head>
<body>
    <h1>Upload Image to GitHub</h1>
    <form id="uploadForm">
        <input type="file" id="imageInput" accept="image/*" required>
        <button type="submit">Upload</button>
    </form>
    <p id="status"></p>

    <script>
        document.getElementById('uploadForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const file = document.getElementById('imageInput').files[0];
            if (!file) {
                alert('Please select an image to upload.');
                return;
            }

            const status = document.getElementById('status');
            status.textContent = 'Uploading...';

            try {
                const response = await uploadImageToGitHub(file);
                status.textContent = 'Upload successful!';
                console.log('Image uploaded:', response);
            } catch (error) {
                status.textContent = 'Upload failed.';
                console.error('Error uploading image:', error);
            }
        });

        async function uploadImageToGitHub(file) {
    const repoOwner = 'radheeshm';
    const repoName = 'stockimages';
    const filePath = `images/${file.name}`;
    const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;

    const token = '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';

    console.log('Uploading file:', file.name);
    console.log('API URL:', apiUrl);

    const fileContent = await readFileAsBase64(file);

    const response = await fetch(apiUrl, {
        method: 'PUT',
        headers: {
            'Authorization': `token ${token}`,
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            message: `Upload ${file.name}`,
            content: fileContent,
        }),
    });

    console.log('Response status:', response.status);
    console.log('Response data:', await response.json());

    if (!response.ok) {
        throw new Error(`GitHub API error: ${response.statusText}`);
    }

    return response.json();
}

        function readFileAsBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => {
                    const base64Content = reader.result.split(',')[1];
                    resolve(base64Content);
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }
    </script>
</body>
</html>
